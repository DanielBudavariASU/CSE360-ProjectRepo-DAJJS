This is the final code of Phase 1. 
